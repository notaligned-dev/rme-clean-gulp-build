# Rem Markup Engine — Чистая сборка Gulp

[:us: English language](README.md)

Полный журнал изменений проекта [доступен по ссылке :bookmark_tabs:](CHANGELOG.ru.md)

> [!NOTE] 
> Сборка находится в **бете**. API и структура могут измениться  до выхода первой стабильной версии.

Эта сборка предназначена для быстрой и удобной разработки вебсайтов. Никаких лишних модулей, чистый и минималистичный набор для разработки вебсайтов без frontend-фреймворков.

Для кого подойдёт сборка?
- Темы для CMS (преимущественно Wordpress, OpenCart)
- Вебсайты без frontend-фреймворков
- Статичная вёрстка

## Быстрый старт

Перед началом установки убедитесь, что у вас установлено всё необходимое:
- Node.js >= 24
- npm >= 11

> [!TIP]
> Перечисленные требования взяты с системы, на которой проект был собран и работал стабильно, из-за чего указаны довольно свежие версии программ. Сборка может работать стабильно и на более ранних версиях.

### Шаг 1 —  Загрузка.

У вас есть два варианта: 
1. **Рекомендованный**: скачать последнюю версию сборки [здесь](https://github.com/notaligned-dev/rme-clean-gulp-build/releases).
2. Клонировать репозиторий по HTTPS в желаемую папку. Чтобы это сделать, запустите следующую команду в консоли:
 
```
git clone --recurse-submodules https://github.com/notaligned-dev/rme-clean-gulp-build.git
```

### Шаг 2 — Установка зависимостей.

Откройте терминал в папке с файлами проекта и запустите следующую команду:

```
npm install
```

Дождитесь конца установки и убедитесь, что всё прошло успешно.

### Шаг 3 (Необязательный) — Настройка конфигурации

Конфигурации — это набор настроек для изменения процесса работы для ваших нужд.

Gulp использует конфигурации из `./gulp/config/`, вы можете:
1) Изменить существующую конфигурацию (рекомендуется `custom.config.js`, чтобы не потерять настройки при обновлениях)
2) Создать свой собственный файл конфигурации и назвать его по принципу: `your-name.config.js`

Каждая конфигурация наследует настройки из `./gulp/globals/base.config.js`. Вы можете посмотреть все настройки внутри этого файла или в [соответствующей секции](#user-content-настройки-конфигураций).

### Шаг 4 — Запуск.

Всё готово! Для запуска Gulp запустите один из NPM скриптов (вы также можете запустить Gulp вручную из консоли):
- `dev` — запускает процесс для разработчика
- `build` — собирает файлы для боевого сайта
- `lint` — запускает линтинг JS файлов (проверка ошибок)

У некоторых скриптов есть аналоги с другим окончанием вроде `build:custom`. Имя после двоеточия отвечает за используемую конфигурацию (подробнее в прошлом шаге).

С этого момента Gulp должен работать. **Настоятельно рекомендуется** прочитать секцию *[Принцип работы](#user-content-принцип-работы)*

## Принцип работы

После запуска Gulp обрабатывает ваши файлы, чтобы сделать их оптимальными для разработки или боевого сайта.

`gulp dev` пересобирает файлы при каждом изменении. SCSS превращается в CSS, JS обрабатывается через Babel для наилучшей поддержки старых браузеров.
Он также включает быструю перезагрузку браузера. Чтобы воспользоваться ей, откройте URL сервера `browser-sync`, отображаемый в консоли, либо добавьте его порт к вашему локальному домену (перед параметрами).

`gulp build` собирает файлы один раз, а затем оптимизирует их. Вдобавок к задаче `dev` CSS файл минифицируется и дополняется префиксами для кросс-браузерной поддержки, а изображения превращаются в формат `.webp`. 

Для запуска разных конфигураций необходимо запустить Gulp с установленной переменной окружения `BUILD_CONFIG=name`, где `name` является названием файла конфигурации. Например `custom` — это имя файла `custom.config.js`.

## Возможности и инструменты
Сборка включает в себя следующее:
- SCSS
    1. Автопрефиксер и минификация для боевого сайта
    2. Sourcemaps (карты кода)
- JS
    1. Сборщик ESBuild
    2. Babel для поддержки старых браузеров
    3. Скрипт для линтера (запускается отдельно)
- Система конфигурации
- Быстрая перезагрузка браузера
- Конвертация изображений в `webp`
- Отображение ошибок

Проект использует [Rem Markup Engine Theme](https://github.com/notaligned-dev/rem-markup-engine-theme) в качестве сабмодуля для исходников ресурсов (не обязательно)

> [!NOTE]
> Если вы не знакомы с технологиями SCSS или Babel, вам следует ознакомиться с документацией в официальных источниках.

## Настройки конфигураций

Все свойства конфгураций (перечислены в `./gulp/globals/base.config.js`):
- `sourceFolder` — папка для исходных файлов
- `buildFolder` — папка для выходных файлов
- `isProxy` — установите значение `true`, если вы работаете со своим локальным сервером и хотите использовать на нём быструю перезагрузку браузера
- `localWebsiteURL` — работает только с `isProxy`: `true`. Впишите URL своего локального вебсайта
- `isWebpConvertion` — включение/выключения конвертирования в`webp`

## Структура папок

Эта структура файлов, необходимая для корректной работы сборки. Вы можете менять пути и логику внутри файлов Gulp.

```powershell
rme-clean-gulp-build
├───gulp                # все файлы Gulp
│   ├───config          # конфигурации
│   ├───globals
│   ├───tasks 
│   └───index.js        # точка входа Gulp
├───src
│   ├───assets          # стандартная структура папки с исходниками
│   │   ├───fonts
│   │   ├───img
│   │   ├───js
│   │   │   └───libs
│   │   ├───scss        # рекомендуется структура DART SASS 3.0
│   │   └───videos
│   └───theme           # rme-theme сабмодуль (не обязательно)
├───.eslintrc.json      # настройки линтинга javascript
├───babel.config.js     # настройки babel
├───CHANGELOG.md
├───LICENSE
├───package-lock.json
├───package.json 
└───README.md           # Вы находитесь здесь
```

## Лицензия

GNU General Public License v3.0